import captureImage from"./imageCapture.min.js";window.VerIDImageCapture={UnsupportedDeviceError:function(){this.name="UnsupportedDeviceError",this.message="Unsupported device"},UnsupportedBrowserError:function(){this.name="UnsupportedBrowserError",this.message="Unsupported browser"},Cancellation:function(){this.name="Cancellation",this.message="Capture cancelled by user"},PermissionDenied:function(){this.name="PermissionDenied",this.message="Camera permission denied by user"},generateQRCode:function(e){return new Promise((function(t,n){t(QRCode.generatePNG(e,{ecclevel:"M",format:"html",fillcolor:"#FFFFFF",textcolor:"#000000",margin:4,modulesize:8}))}))},captureImages:function(e){return new Promise((function(t,n){var r=document.createElement("style");function a(){r&&r.parentNode&&r.parentNode.removeChild(r),r=null}r.innerHTML="#veridCaptureContainer{position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.5);padding:16px}#veridCaptureContainer{font-family:Helvetica,Arial,sans-serif}#veridCaptureContainer div.dialog{position:relative;top:50%;transform:translateY(-50%);max-width:300px;margin:auto;text-align:center;box-shadow:0 5px 10px rgba(0,0,0,.2);border-radius:12px;background-color:#fff;padding:32px}#veridCaptureContainer details{margin-top:32px}#veridCaptureContainer a,#veridCaptureContainer details summary{text-align:center;cursor:pointer;text-decoration:none;color:#06c}#veridCaptureContainer a.triggerButton{display:block}#veridCaptureContainer a.cancelButton{position:absolute;top:8px;right:8px;color:#fff;background-color:#06c;padding:2px 4px;border-radius:8px}#veridCaptureContainer img.captured{display:block;width:100%;border-radius:8px;margin-bottom:16px}",document.head.appendChild(r),e||(e={images:["front","back"],prompts:{front:"Capture the front of your ID",back:"Capture the back of your ID"}}),e.images||(e.images=["front","back"]),e.prompts||(e.prompts={}),e.trigger||e.images.forEach((function(t){if(!e.prompts[t])switch(t){case"front":e.prompts[t]="Capture the front of your ID";break;case"back":e.prompts[t]="Capture the back of your ID";break;case"passport":e.prompts[t]="Capture the picture page of your passport"}}));var o={};!function r(i){if(i<e.images.length){var c=i>0?o[e.images[i-1]]:null;(p=e.trigger,u=e.prompts[e.images[i]],s=e.useFrontCamera?"user":"environment",d=c,m=e.link,l=!1,new Promise((function(e,t){var n;function r(){n&&n.parentNode&&n.parentNode.removeChild(n),a&&a.parentNode&&a.parentNode.removeChild(a),a=null,n=null}var a=document.createElement("input");if(a.setAttribute("type","file"),a.setAttribute("accept","image/*"),a.setAttribute("capture",s||"environment"),a.style.opacity=0,a.style.position="absolute",a.style.zIndex=0,a.onchange=function(){var n=new FileReader;n.onload=function(t){var n=t.target.result;r(),l||setTimeout((function(){e(n)}))},n.onerror=function(e){r(),l||setTimeout((function(){t()}))},n.readAsDataURL(this.files[0])},document.body.appendChild(a),!p){(p=document.createElement("a")).innerText=u||"Capture image",p.className="triggerButton",(n=document.createElement("div")).id="veridCaptureContainer";var o=document.createElement("a");o.innerHTML="&times;",o.className="cancelButton",o.onclick=function(){return l=!0,r(),setTimeout((function(){t(new VerIDImageCapture.Cancellation)})),!1};var i=document.createElement("div");if(i.className="dialog",n.appendChild(i),d){var c=document.createElement("img");c.className="captured",c.src=d,i.appendChild(c)}m&&VerIDImageCapture.generateQRCode(m).then((function(e){var t=document.createElement("img");t.src=e;var n=document.createElement("details"),r=document.createElement("summary"),a=document.createElement("div");a.innerText="Scan the QR code to continue on another device",r.innerText="Use another device",n.appendChild(r),n.appendChild(t),n.appendChild(a),i.appendChild(n)})).catch((function(e){})),i.appendChild(p),i.appendChild(o),document.body.appendChild(n)}u&&(p.innerText=u),p.onclick=function(){return captureImage("user"!=s),!1}}))).then((function(t){o[e.images[i]]=t,r(i+1)})).catch((function(e){a(),setTimeout((function(){n(e)}))}))}else a(),setTimeout((function(){t(o)}));var p,u,s,d,m,l}(0)}))}};