window.VerIDImageCapture={UnsupportedDeviceError:function(){this.name="UnsupportedDeviceError",this.message="Unsupported device"},UnsupportedBrowserError:function(){this.name="UnsupportedBrowserError",this.message="Unsupported browser"},Cancellation:function(){this.name="Cancellation",this.message="Capture cancelled by user"},generateQRCode:function(e){return new Promise((function(t,r){t(QRCode.generatePNG(e,{ecclevel:"M",format:"html",fillcolor:"#FFFFFF",textcolor:"#000000",margin:4,modulesize:8}))}))},captureImages:function(e){return new Promise((function(t,r){if(!navigator.mediaDevices)return r(new VerIDImageCapture.UnsupportedBrowserError);var i=navigator.mediaDevices.getSupportedConstraints();if(!0!==i.width||!0!==i.height)return r(new VerIDImageCapture.UnsupportedBrowserError);var o={video:{width:{min:3e3}},audio:!1};e&&e.minImageWidth&&(o.video.width.min=e.minImageWidth),!0===i.facingMode&&(o.video.facingMode={exact:e.useFrontCamera?"user":"environment"});var n=[];window.onresize&&n.push(window.onresize),window.onresize=function(e){for(var t=0;t<n.length;t++)n[t](e)},navigator.mediaDevices.getUserMedia(o).then((function(i){var o=document.createElement("style");o.innerHTML="#veridCameraPreview{position:fixed;left:0;top:0;width:100%;height:100%;background-color:#000;font-family:Helvetica,Arial,sans-serif}#veridCameraPreview .prompt{position:absolute;top:0;left:0;right:0;height:40px;background-color:#000;color:#fff;text-align:center;padding:5px;vertical-align:middle;display:flex;align-items:center;justify-content:center}#veridCameraPreview .cardOutline{position:absolute;width:90vw;height:calc(90vw * .63);top:0;right:0;left:0;bottom:0;margin:auto}#veridCameraPreview .cardOutline .corner{position:absolute;width:15%;height:0;padding-top:15%}#veridCameraPreview .cardOutline .corner.top{top:0;border-top:2px solid #fff}#veridCameraPreview .cardOutline .corner.bottom{bottom:0;border-bottom:2px solid #fff}#veridCameraPreview .cardOutline .corner.left{left:0;border-left:2px solid #fff}#veridCameraPreview .cardOutline .corner.right{right:0;border-right:2px solid #fff}#veridCameraPreview .cardOutline .corner.top.left{border-top-left-radius:25%}#veridCameraPreview .cardOutline .corner.top.right{border-top-right-radius:25%}#veridCameraPreview .cardOutline .corner.bottom.left{border-bottom-left-radius:25%}#veridCameraPreview .cardOutline .corner.bottom.right{border-bottom-right-radius:25%}#veridCameraPreview .shutterButton{position:absolute;left:0;right:0;bottom:20px;width:64px;height:64px;border-radius:34px;background-color:#fff;margin:auto;border:4px solid #000;box-shadow:0 0 0 3px #fff;cursor:pointer;z-index:100}#veridCameraPreview .shutterButton svg{position:absolute;left:14px;top:14px}#veridCameraPreview .cancelButton{position:absolute;left:20px;bottom:20px;color:#fff;cursor:pointer;z-index:99}#veridCameraPreview .videoPlayerContainer{position:absolute;top:50px;left:0;bottom:50px;right:0;overflow:hidden}#veridCameraPreview .videoPlayerContainer video{position:absolute;top:0;left:0;right:0;bottom:0;width:100%;min-height:100%}#veridCameraPreview .countdown{position:absolute;display:flex;left:0;top:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;vertical-align:center;text-align:center;font-size:144pt;color:#fff;text-shadow:0 2px 3px rgba(0,0,0,.2);animation-duration:.8s;animation-name:fadeOut}@keyframes fadeOut{from{opacity:1}to{opacity:0}}@media (min-aspect-ratio:765/568){#veridCameraPreview .cardOutline{height:calc(90vh - 100px);width:calc((90vh - 100px) * 1.59)}}.flipped{transform:rotateY(180deg)!important;transition:transform 2s}.flipAnimation{position:absolute;top:0;left:0;right:0;bottom:0;perspective:500px;z-index:90}.flipAnimation .card{position:absolute;top:0;left:0;right:0;bottom:0;margin:auto;width:172px;height:108px;border-radius:6px;background-color:#fff;transform:rotateY(0)}",document.head.appendChild(o);var n=document.createElement("div");n.setAttribute("id","veridCameraPreview"),n.innerHTML='<div class=videoPlayerContainer><video autoplay muted playsinline></video><div class=cardOutline><div class="corner top left"></div><div class="corner top right"></div><div class="corner bottom right"></div><div class="corner bottom left"></div></div></div><div class=prompt>Take picture of the front of your ID card</div><div class=shutterButton><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" fill=black width=36px height=36px><path d="M0 0h24v24H0z" fill=none /><circle cx=12 cy=12 r=3.2 /><path d="M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"/></svg></div><a class=cancelButton>Cancel</a>',document.body.appendChild(n);var a,d=document.querySelector("#veridCameraPreview .videoPlayerContainer video"),l=document.querySelector("#veridCameraPreview .prompt"),c=document.querySelector("#veridCameraPreview .cardOutline"),s=document.querySelector("#veridCameraPreview .shutterButton"),u=document.querySelector("#veridCameraPreview .cancelButton");s.style.display="block";var p={};e&&e.images&&Array.isArray(e.images)&&e.images.length>0?(p={},e.images.forEach((function(e){p[e]=null}))):(e||(e={}),e.images=["front","back"],p={front:null,back:null});var m,v=0;function f(){return v<e.images.length?e.images[v]:null}function h(){var t=f();return null==t?null:e&&e.prompts&&"object"==typeof e.prompts&&e.prompts.hasOwnProperty(t)?e.prompts[t]:null}function g(){i.getVideoTracks().forEach((function(e){e.stop()})),s.onclick=null,n.parentNode.removeChild(n)}function w(){a&&a.parentNode&&a.parentNode.removeChild(a),a=null}h()?(l.innerText=h(),l.style.display="block"):l.style.display="none",e&&e.displayCardOutline?c.style.display="block":c.style.display="none","srcObject"in d?d.srcObject=i:d.src=URL.createObjectURL(i),s.onclick=function(){function r(){w(),clearInterval(m);var e=document.createElement("canvas");e.width=d.videoWidth,e.height=d.videoHeight,e.getContext("2d").drawImage(d,0,0,d.videoWidth,d.videoHeight);var r=e.toDataURL("image/jpeg"),i=f();if(i&&!p[i]&&(p[i]=r),v++,l&&h()&&(l.innerText=h()),Object.values(p).includes(null)){s.style.display="block";var o=document.createElement("div");o.className="flipAnimation";var a=document.createElement("div");a.className="card",o.appendChild(a),n.insertBefore(o,s),setTimeout((function(){a.classList.add("flipped")}),10),setTimeout((function(){n.removeChild(o)}),2500)}else g(),setTimeout((function(){t(p)}))}if(s.style.display="none",e.startDelay&&"number"==typeof e.startDelay){var i=0,o=Math.round(e.startDelay);function c(){i>=o?r():((a=document.createElement("div")).className="countdown",a.innerText=o-i+"",a.addEventListener("animationend",w,!1),n.appendChild(a)),i++}c(),m=setInterval(c,1e3)}else r()},u.onclick=function(){w(),clearInterval(m),g(),setTimeout((function(){r(new VerIDImageCapture.Cancellation)}))}})).catch((function(e){return e instanceof OverconstrainedError?e=new VerIDImageCapture.UnsupportedDeviceError:e&&"NotAllowedError"==e.name&&(e=new VerIDImageCapture.Cancellation),r(e)}))}))}};